#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x>9) print(x/10);putchar(x%10+'0');
}
const van MaxN=1e3+10;
van n,m,del[MaxN][MaxN];char ma[MaxN][MaxN];
van VanGo[4][2]={{1,0},{0,1},{-1,0},{0,-1}};
bool hav[MaxN][MaxN],full[MaxN][MaxN];
vector<van> x[MaxN];
bool in(van x,van y) {
	return x>0&&y>0&&x<=n&&y<=m;
}
int main() {
	freopen("1ysa93e.in","r",stdin);
	freopen("1ysa93e.out","w",stdout);
	van num=0;read(n);read(m);for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) 
		cin>>ma[i][j],hav[i][j]=ma[i][j]=='#',num+=hav[i][j];
	if (num==n*m) {print(n+m-2);return 0;}
	van times=0;while (1) { van sum=0;times++;
		for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) {
			if (!hav[i][j]) continue;
			bool save=true;for (int k=0;k<4;k++) {
				van x=i+VanGo[k][0],y=j+VanGo[k][1];
				if (!in(x,y)) continue;
				if (del[x][y]!=times&&!hav[x][y]) save=false;
			} if (!save) sum++,num--,del[i][j]=times,hav[i][j]=false;
		} if (!sum) {
			if (!num) break;
			else for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) 
				for (int k=0;k<4;k++) {
					van x=i+VanGo[k][0],y=j+VanGo[k][1];
					if (!in(x,y)) {
						del[i][j]=times,hav[i][j]=false;
						num--;break;
					}
				}
		}
	} // for (int i=1;i<=n;i++) {for (int j=1;j<=m;j++) cout<<del[i][j];cout<<endl;}
	times--;van l=1,r=times,ans=1e18;
	while (l<=r) {
		van mid=(l+r)>>1;memset(full,0,sizeof full);
		queue<pair<pair<van,van>,van> > q;
		for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) 
			if (del[i][j]>=mid) q.push(make_pair(make_pair(i,j),0)),full[i][j]=1;
		while (!q.empty()) {
			van nowx=q.front().first.first,nowy=q.front().first.second;
			van step=q.front().second;q.pop();
			if (step==mid-1) continue;
			for (int k=0;k<4;k++) {
				van xx=nowx+VanGo[k][0],yy=nowy+VanGo[k][1];
				if (!in(xx,yy)||full[xx][yy]) continue; 
				full[xx][yy]=1;q.push(make_pair(make_pair(xx,yy),step+1));
			}
		} for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) 	
			if (ma[i][j]=='#'&&!full[i][j]) r=mid-1;
		if (r!=mid-1) ans=mid,l=mid+1;
	}
	print(ans-1);
	return 0;
}
/*
Sample Input1: (The weapon to kill €€f)
40 51
...................................................
...................................................
...................................................
...................................................
...................................................
...................................................
.........................#.........................
........................###........................
........................###........................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.................#################.................
................###################................
.................#################.................
........................###........................
........................###........................
........................###........................
........................###........................
........................###........................
........................###........................
.........................#.........................
...................................................
...................................................
...................................................
...................................................
...................................................
...................................................
...................................................
Sample Output1:
1

Sample Input2: (Anthor weapon to kill €€f)
40 51
...................................................
...................................................
...................................................
...................................................
...................................................
...................................................
.........................#.........................
........................###........................
........................###........................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
.......................#####.......................
................###################................
.................#################.................
........................###........................
........................###........................
........................###........................
........................###........................
........................###........................
........................###........................
.........................#.........................
...................................................
...................................................
...................................................
...................................................
...................................................
...................................................
...................................................
...................................................
Sample Output2:
0

Sample Input3:
10 51
...................................................
...................................................
.....########....................#.................
.....#...........................#.................
.....######...#.....#....######..#...##............
.....#........#.....#...#........#.##..............
.....#........#.....#...#........##................
.....#........#.....#...#........#.##..............
.....#.........#####.#...######..#...##............
...................................................
Sample Output3:
0
*/
